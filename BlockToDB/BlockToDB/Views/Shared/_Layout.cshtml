@using Microsoft.AspNet.Identity
@{
    string tab = Context.Request.RequestContext.RouteData.Controller();
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@SharedResource.BlockToDB.ToStringSafe()</title>
    <link rel="shortcut icon" href="~/content/images/logo.svg" />
    @Styles.Render("~/Content/css")
    @Styles.Render("~/Content/DevExtremeBundle")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/Scripts/jqueryGlobalize")
    @Scripts.Render("~/Scripts/jqueryBase64")
    @Scripts.Render("~/Scripts/DevExtremeBundle")
    @Scripts.Render("~/Scripts/DevExtremeBundlePL")
    @Scripts.Render("~/bundles/bootstrap")

    <script src="https://d3js.org/d3-path.v1.min.js"></script>
    <script src="https://d3js.org/d3-shape.v1.min.js"></script>
    <script src="~/Scripts/rete.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.6/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-vue-render-plugin@0.3.5/build/vue-render-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-minimap-plugin@0.3.1/build/minimap-plugin.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/rete-connection-plugin@0.8.3-rc.1/build/connection-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alight@0.14.1/alight.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>
    <script src="~/Scripts/context-menu-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-area-plugin@0.2.1/build/area-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-comment-plugin@0.3.0/build/comment-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-history-plugin@0.1.0/build/history-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-connection-path-plugin@0.2.0/build/connection-path-plugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rete-dock-plugin@0.2.0/build/dock-plugin.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/rete-connection-mastery-plugin@0.1.0/build/connection-mastery-plugin.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="navbar-logo" onclick="goToDashboard()">
                    <i class="fas fa-database"></i>
                    <span class="navbar-logo-text">@SharedResource.BlockToDB.ToStringSafe()</span>
                </div>
                <div class="navbar-wrapper">
                    <ul class="navbar-links">
                        <li class="@(tab == "Creator" ? "is-active" : "")">
                            <a href="@Url.Action("Index", "Creator")"><i class="fas fa-cubes"></i>@SharedResource.Creator.ToStringSafe()</a>
                        </li>
                        @{
                            if (Context.User.Identity.IsAuthenticated)
                            {
                                <li class="@(tab == "Store" ? "is-active" : "")">
                                    <a href="@Url.Action("Index", "Store")"><i class="fas fa-database"></i>@SharedResource.MyDatabase.ToStringSafe()</a>
                                </li>
                            }
                        }
                        <li class="@(tab == "Home" ? "is-active" : "")">
                            <a href="@Url.Action("About", "Home")"><i class="fas fa-info"></i>@SharedResource.About.ToStringSafe()</a>
                        </li>
                    </ul>
                    <ul class="navbar-links">
                        @{
                            if (Context.User.Identity.IsAuthenticated)
                            {
                                <li>
                                    <a href="@Url.Action("LogOff", "Account")"><i class="fas fa-sign-out-alt"></i>@SharedResource.Logout.ToStringSafe()</a>
                                </li>
                            }
                            else
                            {
                                <li>
                                    <a href="@Url.Action("Login", "Account")"><i class="fas fa-sign-in-alt"></i>@SharedResource.Login.ToStringSafe()</a>
                                </li>
                            }
                        }
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)

    <div id="loadPanelId"></div>

    <script>
        $(document).ready(function () {
            $("#loadPanelId").dxLoadPanel({
                shadingColor: "rgba(0,0,0,0.4)",
                visible: false,
                showIndicator: true,
                showPane: true,
                shading: true,
                closeOnOutsideClick: false,
            }).dxLoadPanel("instance");
        });

        function goToDashboard() {
            window.location = "@Url.Action("Index", "Creator")";
        }

        $(document).ready(function () {
            if ($.validator != undefined) {
                $.validator.methods.number = function (value, element) {
                    var globalizationValue = value.replace(".", ",");
                    return this.optional(element) ||
                        !isNaN(Globalize.parseNumber(globalizationValue));
                }

                $.validator.methods.range = function (value, element, param) {
                    if (value === undefined && param.length === 2 && isNaN(param[0]) && isNaN(param[1]))
                    {
                        return false;
                    }
                    if (value === "true" && param.length === 2 && isNaN(param[0]) && isNaN(param[1])) {
                        return true;
                    }

                    var globalizationValue = value.replace(".", ",");
                    return this.optional(element) || (Globalize.parseNumber(globalizationValue) >= param[0] && Globalize.parseNumber(globalizationValue) <= param[1]);
                }
            }
        });
        $(function () {
            var transport = ['webSockets', 'serverSentEvents', 'longPolling', 'foreverFrame'];
            var isChrome = !!window.chrome && !!window.chrome.webstore;
            if (isChrome) {
                transport = ['serverSentEvents', 'longPolling', 'foreverFrame'];
            }
        });

        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
</body>
</html>
